{"stream":"(function e(t,r){if(typeof exports===\"object\"&&typeof module===\"object\")module.exports=r();else if(typeof define===\"function\"&&define.amd)define([],r);else{var o=r();for(var n in o)(typeof exports===\"object\"?exports:t)[n]=o[n]}})(window,function(){return function(e){var t={};function r(o){if(t[o]){return t[o].exports}var n=t[o]={i:o,l:false,exports:{}};e[o].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.d=function(e,t,o){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:o})}};r.r=function(e){if(typeof Symbol!==\"undefined\"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"})}Object.defineProperty(e,\"__esModule\",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e===\"object\"&&e&&e.__esModule)return e;var o=Object.create(null);r.r(o);Object.defineProperty(o,\"default\",{enumerable:true,value:e});if(t&2&&typeof e!=\"string\")for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o};r.n=function(e){var t=e&&e.__esModule?function t(){return e[\"default\"]}:function t(){return e};r.d(t,\"a\",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p=\"\";return r(r.s=0)}([/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\nfunction(e,t,r){\"use strict\";var o=r(/*! @babel/runtime/helpers/interopRequireDefault */1);Object.defineProperty(t,\"__esModule\",{value:true});t.default=l;t.storage=void 0;var n=o(r(/*! @babel/runtime/helpers/objectSpread */2));var a={localName:\"defaultIOKey\",save:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:a.localName;var o=Object.prototype.toString.call(t);if(o===\"[object Object]\"){localStorage.setItem(r,JSON.stringify(t))}else if(o===\"[object String]\"){localStorage.setItem(r,t)}else{console.warn(\"Warn: storage.save() param is no a Object\")}},load:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:a.localName;try{var r=localStorage.getItem(t);if(r){if(typeof r===\"string\"){return JSON.parse(r)}return r}}catch(e){console.warn(\"load last localSate error\")}},clear:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:a.localName;localStorage.setItem(t,{})}};t.storage=a;function l(e,t,r){if(Object.prototype.toString.call(r)!==\"[object Array]\"){console.warn(\"autoStorageSave: params is no a Array\")}a.localName=t||a.localName;var o={};r.forEach(function(e){o[e]=undefined});var l=a.load(a.localName);if(Object.prototype.toString.call(l)===\"[object Object]\"){e.dispatch({type:\"localStorageLoad: IO\",reducer:function e(t){if(t&&t.toJS){var r=(0,n.default)({},t.toJS(),l);for(var o in r){t=t.set(o,r[o])}return t}return(0,n.default)({},t,l)}})}e.subscribe(function(){var t=e.getState();if(t&&t.toJS){var n={};var l=false;r.forEach(function(e){if(Object.prototype.toString.call(e)===\"[object Array]\"){n[e]=t.getIn(e)}else{n[e]=t.get(e)}if(o[e]!==n[e]){l=true}o[e]=n[e]});if(l){a.save(n)}}else{var i={};var u=true;r.forEach(function(e){i[e]=t[e];if(o[e]!==i[e]){u=true}o[e]=i[e]});if(u){a.save(i)}}})}},/*!***************************************************************!*\\\n  !*** external \"@babel/runtime/helpers/interopRequireDefault\" ***!\n  \\***************************************************************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\nfunction(e,t){e.exports=require(\"@babel/runtime/helpers/interopRequireDefault\")},/*!******************************************************!*\\\n  !*** external \"@babel/runtime/helpers/objectSpread\" ***!\n  \\******************************************************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\nfunction(e,t){e.exports=require(\"@babel/runtime/helpers/objectSpread\")}])});","file":"index.js","map":{"version":3,"sources":["index.js"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","a","i","window","modules","installedModules","__webpack_require__","moduleId","l","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","default","autoStorageSave","storage","_objectSpread2","localName","save","v","theKey","arguments","length","undefined","theType","toString","localStorage","setItem","JSON","stringify","console","warn","load","data","getItem","parse","err","clear","store","needSaveKeys","lastDatas","forEach","lastLocalData","dispatch","type","reducer","state","toJS","set","subscribe","getState","nowDatas","isNeedSave","getIn","_nowDatas","_isNeedSave","require"],"mappings":"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","file":"index.js","sourceRoot":""},"input":"(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 1);\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = autoStorageSave;\nexports.storage = void 0;\n\nvar _objectSpread2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/objectSpread */ 2));\n\nvar storage = {\n  localName: \"defaultIOKey\",\n  save: function save(v) {\n    var theKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : storage.localName;\n    var theType = Object.prototype.toString.call(v);\n\n    if (theType === \"[object Object]\") {\n      localStorage.setItem(theKey, JSON.stringify(v));\n    } else if (theType === \"[object String]\") {\n      localStorage.setItem(theKey, v);\n    } else {\n      console.warn(\"Warn: storage.save() param is no a Object\");\n    }\n  },\n  load: function load() {\n    var theKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : storage.localName;\n\n    try {\n      var data = localStorage.getItem(theKey);\n\n      if (data) {\n        if (typeof data === \"string\") {\n          return JSON.parse(data);\n        }\n\n        return data;\n      }\n    } catch (err) {\n      console.warn(\"load last localSate error\");\n    }\n  },\n  clear: function clear() {\n    var theKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : storage.localName;\n    localStorage.setItem(theKey, {});\n  }\n}; // 这里做自动保存的监听\n\nexports.storage = storage;\n\nfunction autoStorageSave(store, localName, needSaveKeys) {\n  if (Object.prototype.toString.call(needSaveKeys) !== \"[object Array]\") {\n    // eslint-disable-next-line\n    console.warn(\"autoStorageSave: params is no a Array\");\n  }\n\n  storage.localName = localName || storage.localName; // 只有Auth和DataCenter的修改会激发IO, lastDats保存之前的记录\n\n  var lastDatas = {};\n  needSaveKeys.forEach(function (v) {\n    lastDatas[v] = undefined;\n  }); // 首次读取\n\n  var lastLocalData = storage.load(storage.localName);\n\n  if (Object.prototype.toString.call(lastLocalData) === \"[object Object]\") {\n    store.dispatch({\n      type: \"localStorageLoad: IO\",\n      reducer: function reducer(state) {\n        // 如果是immutable 使用toJS\n        if (state && state.toJS) {\n          var data = (0, _objectSpread2.default)({}, state.toJS(), lastLocalData);\n\n          for (var key in data) {\n            state = state.set(key, data[key]);\n          }\n\n          return state;\n        } // 非immutable直接合并历史数据\n\n\n        return (0, _objectSpread2.default)({}, state, lastLocalData);\n      }\n    });\n  }\n\n  store.subscribe(function () {\n    var state = store.getState();\n\n    if (state && state.toJS) {\n      //immutable 类型\n      var nowDatas = {};\n      var isNeedSave = false;\n      needSaveKeys.forEach(function (v) {\n        // 监听数据和 Immutable 配合做低开销校验\n        if (Object.prototype.toString.call(v) === \"[object Array]\") {\n          nowDatas[v] = state.getIn(v);\n        } else {\n          nowDatas[v] = state.get(v);\n        }\n\n        if (lastDatas[v] !== nowDatas[v]) {\n          isNeedSave = true;\n        }\n\n        lastDatas[v] = nowDatas[v];\n      });\n\n      if (isNeedSave) {\n        storage.save(nowDatas);\n      }\n    } else {\n      // 非immutable做浅比较判断是否需要保存\n      var _nowDatas = {};\n      var _isNeedSave = true;\n      needSaveKeys.forEach(function (v) {\n        _nowDatas[v] = state[v];\n\n        if (lastDatas[v] !== _nowDatas[v]) {\n          _isNeedSave = true;\n        }\n\n        lastDatas[v] = _nowDatas[v];\n      });\n\n      if (_isNeedSave) {\n        storage.save(_nowDatas);\n      }\n    }\n  });\n}\n\n/***/ }),\n/* 1 */\n/*!***************************************************************!*\\\n  !*** external \"@babel/runtime/helpers/interopRequireDefault\" ***!\n  \\***************************************************************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\n/***/ }),\n/* 2 */\n/*!******************************************************!*\\\n  !*** external \"@babel/runtime/helpers/objectSpread\" ***!\n  \\******************************************************/\n/*! no static exports found */\n/*! all exports used */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"@babel/runtime/helpers/objectSpread\");\n\n/***/ })\n/******/ ]);\n});","inputSourceMap":{"version":3,"sources":["webpack/universalModuleDefinition","webpack/bootstrap","/Users/pillar/work/hub/redux-auto-local-storage/src/index.js","external \"@babel/runtime/helpers/interopRequireDefault\"","external \"@babel/runtime/helpers/objectSpread\""],"names":["storage","localName","save","v","theKey","theType","Object","prototype","toString","call","localStorage","setItem","JSON","stringify","console","warn","load","data","getItem","parse","err","clear","autoStorageSave","store","needSaveKeys","lastDatas","forEach","undefined","lastLocalData","dispatch","type","reducer","state","toJS","key","set","subscribe","getState","nowDatas","isNeedSave","getIn","get"],"mappings":"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","file":"x","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export const storage = {\n  localName: \"defaultIOKey\",\n  save: (v, theKey = storage.localName) => {\n    const theType = Object.prototype.toString.call(v);\n    if (theType === \"[object Object]\") {\n      localStorage.setItem(theKey, JSON.stringify(v));\n    } else if (theType === \"[object String]\") {\n      localStorage.setItem(theKey, v);\n    } else {\n      console.warn(\"Warn: storage.save() param is no a Object\");\n    }\n  },\n  load: (theKey = storage.localName) => {\n    try {\n      const data = localStorage.getItem(theKey);\n      if (data) {\n        if (typeof data === \"string\") {\n          return JSON.parse(data);\n        }\n        return data;\n      }\n    } catch (err) {\n      console.warn(\"load last localSate error\");\n    }\n  },\n  clear: (theKey = storage.localName) => {\n    localStorage.setItem(theKey, {});\n  }\n};\n\n// 这里做自动保存的监听\nexport default function autoStorageSave(store, localName, needSaveKeys) {\n  if (Object.prototype.toString.call(needSaveKeys) !== \"[object Array]\") {\n    // eslint-disable-next-line\n    console.warn(\"autoStorageSave: params is no a Array\");\n  }\n  storage.localName = localName || storage.localName;\n  // 只有Auth和DataCenter的修改会激发IO, lastDats保存之前的记录\n  const lastDatas = {};\n  needSaveKeys.forEach(v => {\n    lastDatas[v] = undefined;\n  });\n  // 首次读取\n  const lastLocalData = storage.load(storage.localName);\n  if (Object.prototype.toString.call(lastLocalData) === \"[object Object]\") {\n    store.dispatch({\n      type: \"localStorageLoad: IO\",\n      reducer: state => {\n        // 如果是immutable 使用toJS\n        if (state && state.toJS) {\n          const data = {\n            ...state.toJS(),\n            ...lastLocalData\n          };\n          for (const key in data) {\n            state = state.set(key, data[key]);\n          }\n          return state;\n        }\n        // 非immutable直接合并历史数据\n        return {\n          ...state,\n          ...lastLocalData\n        };\n      }\n    });\n  }\n  store.subscribe(() => {\n    const state = store.getState();\n    if (state && state.toJS) {\n      //immutable 类型\n      const nowDatas = {};\n      let isNeedSave = false;\n      needSaveKeys.forEach(v => {\n        // 监听数据和 Immutable 配合做低开销校验\n        if (Object.prototype.toString.call(v) === \"[object Array]\") {\n          nowDatas[v] = state.getIn(v);\n        } else {\n          nowDatas[v] = state.get(v);\n        }\n        if (lastDatas[v] !== nowDatas[v]) {\n          isNeedSave = true;\n        }\n        lastDatas[v] = nowDatas[v];\n      });\n      if (isNeedSave) {\n        storage.save(nowDatas);\n      }\n    } else {\n      // 非immutable做浅比较判断是否需要保存\n      const nowDatas = {};\n      let isNeedSave = true;\n      needSaveKeys.forEach(v => {\n        nowDatas[v] = state[v];\n        if (lastDatas[v] !== nowDatas[v]) {\n          isNeedSave = true;\n        }\n        lastDatas[v] = nowDatas[v];\n      });\n      if (isNeedSave) {\n        storage.save(nowDatas);\n      }\n    }\n  });\n}\n","module.exports = require(\"@babel/runtime/helpers/interopRequireDefault\");","module.exports = require(\"@babel/runtime/helpers/objectSpread\");"]}}